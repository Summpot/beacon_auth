name = "beacon-auth"
main = "build/worker/shim.mjs"
compatibility_date = "2025-12-18"

[assets]
# The frontend build output is copied here during CI (and can be generated locally).
directory = "./assets"
# Optional binding name (useful for manual fetching); we mainly rely on routing.
binding = "ASSETS"
# SPA fallback: unknown paths (e.g. /login) return index.html.
not_found_handling = "single-page-application"
# Ensure API routes always execute the Rust worker logic.
run_worker_first = ["/api/*", "/v1/*", "/.well-known/*"]

[[d1_databases]]
binding = "DB"
database_name = "beacon-auth"
database_id = "REPLACE_WITH_D1_DATABASE_ID"

[vars]
BASE_URL = ""
JWT_KID = "beacon-auth-key-1"
ACCESS_TOKEN_EXPIRATION = "900"
REFRESH_TOKEN_EXPIRATION = "2592000"
JWT_EXPIRATION = "3600"

[[rules]]
type = "CompiledWasm"
globs = ["**/*.wasm"]
